## mako

<%page expression_filter="h" args="badge_assertion, badge_class, badge_meta"/>
<%namespace name='static' file='../static_content.html'/>
<%!
from django.utils.translation import ugettext as _
from openedx.core.djangolib.js_utils import dump_js_escaped_json, js_escaped_string
%>


<link rel="stylesheet" href="/static/css/bootstrap/lms-main.css" type="text/css" media="all">

<script src="${static.url('js/lms-base-vendor.js')}"></script>
<script src="${static.url('js/certificates/certificates.js')}"></script>

<%block name="js_extra">
    <script type="text/javascript">
      $(document).ready(function() {

        $('#progress-details-share').accordion({
          active: false,
          collapsible: true,
          heightStyle: "content"
        });

        $('#progress-details-share').click(function () {
            $('#progress-details-share-icon').toggleClass('fa-angle-down fa-angle-up');
        });

      });
    </script>
</%block>

<div class="badges-overlay" style="display:none;">
    <div class="badges-modal">
        <div class="close"><span class="fa fa-close" alt="Close" aria-hidden="true"><input type="button" class="sr-only" value="Close"/></span></div>
        <h1 class="hd-1 emphasized">Share your Open Badge with Badgr</h1>
        <p class="explanation">Your achievement has been recognized with a badge. This is an <a href="https://openbadges.org/" target="_blank">Open Badge</a>, a digital image file with information embedded in it that is unique to you and your accomplishment.</p>

        <div className="progress-details" style="background-color: #e4e4e4; padding: 20px;">
              <div className="progress-details-header mb-5">
                <div className="progress-details-title row w-100">
                  <h2 className="col">${_(badge_class.get('display_name'))}</h2>
                </div>
                <div className="progress-details-description row w-100">
                  <div className="col">
                    ${_(badge_class.get('description'))}
                  </div>
                </div>
              </div>
              <div className="progress-details-body row w-100">
                <div className="progress-details-image col col-3" style="width: 30%; display: inline-block; margin: 20px;">

                    <img src="${badge_assertion.get('image')}" alt="${_(badge_class.get('display_name'))}" style="max-width: 70%; margin: 10px 40px;" />

                    <button class="btn btn-primary" type="button" onclick="window.open('https://badgr.io/recipient/badges', '_blank');" style="max-width: 80%; width: 100%; margin: 5px 30px;">
                      <div class="share-prefix" aria-hidden="true">View Backpack</div>
                    </button>

                </div>
                <div className="progress-details-meta col col-9" style="width: 50%; display: inline-block; margin: 20px;">
                    % if badge_assertion.get('issuedOn'):
                    <div className="progress-details-meta-earned" style="margin-bottom: 25px;">
                        <h3>Earned</h3>
                        <p id="badge-details-issued-date">
                            <script type="text/javascript">
                                $(document).ready(function() {
                                   var issuedOnDate = moment( "${badge_assertion.get('issuedOn') | n, js_escaped_string }" ).format("MMM DD, YYYY");
                                   $("#badge-details-issued-date").text(issuedOnDate);
                                });
                            </script>
                        </p>
                    </div>
                    % endif
                    % if badge_assertion.get('recipient'):
                        <div className="progress-details-meta-recipient">
                          <h3>Recipient</h3>
                          <p>${_(badge_assertion.get('recipient').get('plaintextIdentity'))}</p>
                        </div>
                    % endif
                    % if badge_class.get('criteria'):
                        <div className="progress-details-meta-criteria">
                          <h3>Criteria</h3>
                          <p id="badge-details-criteria">
                              <script type="text/javascript">
                                  $(document).ready(function() {
                                      var converter = new Markdown.Converter();
                                      $("#badge-details-criteria").html(converter.makeHtml( "${badge_class.get('criteria') | n, js_escaped_string }" ));
                                  });
                              </script>
                          </p>
                        </div>
                    % endif

                </div>
              </div>

        </div>

        <hr class="modal-hr"/>

        <div class="accordion" id="progress-details-share">
        <h3>
            <div class="card">
                <div class="card-header">
                  <h5 class="mb-0">
                      Badgr Share Details
                      <span id="progress-details-share-icon" class="ml-2 float-right collapsible-icon fa fa-angle-down"></span>
                  </h5>
                </div>
            </div>
        </h3>
        <div style="padding: 1.25rem; background-color: #fff; border: 1px solid rgba(0,0,0,.125); border-radius: .25rem;">
            <p class="explanation">Badgr is a service that creates and stores Open Badges and lets you share them with others. To share your badge using Badgr, you can send a link to a web page about your badge to others.  You can also send the badge image file directly to others, and they can use a badge verification service from Badgr to confirm your accomplishment.  For more options, you must first have a Badgr account. You should have received an email the first time you received a badge with instructions about creating a Badgr account.  Once you have a Badgr account, you can organize your badges in a Backpack and access tools to help share your badges on social media, embed them in web pages, and more.
            </p>
            <img class="backpack-logo" src="${static.url('badges/images/badgr-logo.svg')}">
            <ol class="badges-steps">
                <li class="step">Create a <a class="badge-link" href="${badge_meta['badges_backend_public_url']}" target="_blank">Badgr</a> account, or <a class="badge-link" href="${badge_meta['badges_backend_public_url']}/login" target="_blank">log in</a> to your existing account;</li>
                <li class="step"><a class="badge-link" href="${badge.assertion_url}" target="_blank">Share this public URL to your badge</a>; or</li>
                <li class="step"><a class="badge-link" href="${badge.image_url}" target="_blank">Download your badge (right-click or option-click, save as)</a> and share it directly with others.  They can verify it's really yours at <a class="badge-link" href="https://badgecheck.io" target="_blank">https://badgecheck.io</a>.</li>
            </ol>
        </div>
    </div>
</div>
